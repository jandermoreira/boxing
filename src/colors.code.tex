\ExplSyntaxOn

\cs_generate_variant:Nn \int_set:Nn { cn }
\cs_generate_variant:Nn \seq_set_split:Nnn { cnn }

\tl_new:N \g_current_fg_color_tl
\tl_new:N \g_current_bg_color_tl
\tl_set:Nn \g_current_fg_color_tl { normal~text.fg }
\tl_set:Nn \g_current_bg_color_tl { none }
\seq_new:N \l_color_seq

\cs_new:Npn \reset_color:n #1 {
    \int_set:cn { g_#1_current_int } { 0 }
    \tl_gset:Nn \g_current_fg_color_tl {
        \seq_item:cn { g_#1_colors_seq  }{ 1 }
    }

}
\cs_new:Npn \new_color_list:n #1 {
    \seq_new:c { g_#1_colors_seq }
    \int_new:c { g_#1_current_int }
    \reset_color:n { #1 }
}
\cs_new:Npn \set_color_list:nn #1#2 {
    \seq_set_split:cnn { g_#1_colors_seq } { , } { #2 }
}
\cs_new:Npn \set_fg_bg:n #1 {
    \regex_extract_once:nnNTF { (.*?)\s*on\s*(.*) } { #1 } \l_color_seq {
        \tl_gset:Nn \g_current_fg_color_tl { \seq_item:Nn \l_color_seq { 2 } }
        \tl_gset:Nn \g_current_bg_color_tl { \seq_item:Nn \l_color_seq { 3 } }
    } {
        \tl_gset:Nn \g_current_fg_color_tl { normal~text.fg }
        \tl_gset:Nn \g_current_bg_color_tl { #1 }
    }
}
\cs_new:Npn \use_color:n #1 {
    \tl_set:Nn \l_current_color_tl {
        \seq_item:cn { g_#1_colors_seq  }{\int_use:c { g_#1_current_int } + 1 }
    }
    \exp_args:Ne \set_fg_bg:n \l_current_color_tl
}
\cs_new:Npn \step_color:n #1 {
    \int_if_exist:NTF \l_index_int {} { \int_new:N \l_index_int }
    \int_set:Nn \l_index_int { \int_use:c { g_#1_current_int } }
    \tl_gset:Nn \g_current_fg_color_tl {
        \seq_item:cn { g_#1_colors_seq  }{ \int_eval:n {\int_use:N  \l_index_int + 1} }
    }
    \int_gset:cn { g_#1_current_int } {
        \int_mod:nn { \l_index_int + 1 } { \seq_count:c { g_#1_colors_seq } }
    }
}
\cs_new:Npn \get_current_fg_color: {
    \tl_use:N \g_current_fg_color_tl
}
\cs_new:Nn \get_current_bg_color: {
    \tl_use:N \g_current_bg_color_tl
}


% document commands
\NewDocumentCommand{\SetColorList}{mm}{
    \set_color_list:nn { #1 } { #2 }
}
\NewDocumentCommand{\NewColorList}{m}{
    \new_color_list:n { #1 }
}

\NewDocumentCommand{\StepColor}{m}{
    \step_color:n { #1 }
}
\NewDocumentCommand{\ResetColors}{m}{
    \reset_color:n { #1 }
}
\NewExpandableDocumentCommand{\UseColor}{m}{
    \use_color:n { #1 }
}
\NewExpandableDocumentCommand{\CurrentFGColor}{}{
    \get_current_fg_color:
}
\NewExpandableDocumentCommand{\CurrentBGColor}{}{
    \get_current_bg_color:
}

\ExplSyntaxOff


% Pallete I
\definecolor{LightCornflowerBlue}{HTML}{8ecae6}
\definecolor{Blue Green}{HTML}{219ebc}
\definecolor{Prussian Blue}{HTML}{023047}
\definecolor{Selective Yellow}{HTML}{ffb703}
\definecolor{Tangerine}{HTML}{fb8500}
\NewColorList{palette_i}
\SetColorList{palette_i}{
    black on Selective Yellow,
    black on Blue Green,
    black on Tangerine,
    white on Prussian Blue,
    black on LightCornflowerBlue
}


\definecolor{dDarkBlue}{HTML}{14163B}
\definecolor{dBrown}{HTML}{804722}
\definecolor{dBlue}{HTML}{0264C7}
\definecolor{dLightYellow}{HTML}{F5EDD0}
\definecolor{dGreen}{HTML}{065C61}

\definecolor{dDarkJungleGreen}{HTML}{051D1A}
\definecolor{dHunterGreen}{HTML}{345B3F}
\definecolor{dCaputMortuum}{HTML}{5E2325}
\definecolor{dGamboge}{HTML}{D89818}
\definecolor{dRussianViolet}{HTML}{470E4A}
